# 伽马函数数值计算实验报告


## 1. 实验目的

本次实验的主要目的是学习并应用数值积分方法，特别是通过变量代换技术，来计算伽马函数 $\Gamma(a)$ 的值，并验证其性质。

## 2. 实验方法

**2.1 被积函数可视化:**
使用 Python 的 `numpy` 和 `matplotlib` 库绘制伽马函数被积函数 $f(x, a) = x^{a-1} e^{-x}$ 在 $a=2, 3, 4$ 时于区间 $x \in [0, 5]$ 的图像。

**2.2 变量代换:**
为了提高数值积分精度，采用变量代换 $z = \frac{x}{c+x}$，其中 $c=a-1$，将积分区间 $[0, \infty)$ 变换到 $[0, 1)$。推导出变换后的被积函数 $g(z, a)$：

$g(z, a) = \left[ \frac{cz}{1-z} \right]^{a-1} e^{-\frac{cz}{1-z}} \cdot \frac{c}{(1-z)^2}$
(或使用对数优化形式： $g(z, a) = \exp\left((a-1)\log\left(\frac{cz}{1-z}\right) - \frac{cz}{1-z}\right) \cdot \frac{c}{(1-z)^2}$ )
其中 $c=a-1$。

**2.3 数值积分方法:**
实现 `gamma_function(a)` 函数，该函数使用 [ **请在此处填写你选择的数值积分方法，例如：高斯-勒让德积分 (N=[填写点数]点) ** ] 计算变换后的积分 $\int_0^1 g(z, a) dz$。

## 3. 实验结果

**3.1 被积函数图像:**

![Uploading image.png…]()


**图像说明:** (简要描述图像特征，例如峰值位置随 a 的变化等)
 - **函数曲线**：图中展示了伽马函数被积函数 \(f(x;a)=x^{a - 1}e^{-x}\) 在不同参数 \(a\) 取值下的曲线 ，分别为 \(a = 2\)（蓝色）、\(a = 3\)（绿色）、\(a = 4\)（紫色），还有表示在 \(x = 1\) 处峰值的橙色点。
 - **峰值位置**：随着 \(a\) 值从 \(2\) 增大到 \(4\) ，曲线峰值位置逐渐向右移动 。\(a = 2\) 时，曲线峰值对应的 \(x\) 值相对较小；\(a = 3\) 时，峰值位置右移；\(a = 4\) 时，峰值位置进一步右移，且紫色曲线（\(a = 4\)）的峰值明显高于其他两条曲线（\(a = 2\)、\(a = 3\)） 。橙色点标记的 \(x = 1\) 处，对应着不同 \(a\) 值曲线的特定位置，可作为观察曲线变化的一个参考位置。 
 - **曲线趋势**：各条曲线在 \(x = 0\) 处均从原点出发，随着 \(x\) 增大先上升达到峰值，之后逐渐下降，向 \(x\) 轴趋近 。随着 \(a\) 值增大，曲线在上升和下降阶段的变化速率也有所不同，整体曲线形状变得更“陡峭” 。 

**3.2 Γ(1.5) 计算结果:**

| 计算量        | 数值                     |
| :------------ | :----------------------- |
| 计算值        | 0.88622693 |
| 精确值 ($\sqrt{\pi}/2$) | $\approx 0.886227$       |
| 相对误差      | 1.87e-14     |

**3.3 整数 Γ(a) 计算结果:**

| a   | 计算值 Γ(a)          | 精确值 (a-1)! | 相对误差             |
| :-- | :------------------- | :------------ | :------------------- |
| 3   | 2.000000e+00 | 2             | 0.00e+00 |
| 6   | 1.200000e+02 | 120           | 1.18e-16 |
| 10  | 3.628800e+05| 362880        | 3.21e-16|

## 4. 分析与讨论

**4.1 峰值位置推导 (Task 2):**

(简述 $f(x, a) = x^{a-1} e^{-x}$ 对 $x$ 求导，令导数为零，解得 $x=a-1$ 的过程)
[在此处写下你的推导过程或关键步骤]

**4.2 变量代换推导 (Task 3):**

*   当 $z=1/2$ 时， $1/2 = x/(c+x) \implies c+x = 2x \implies x=c$。
*   为使峰值 $x=a-1$ 映射到 $z=1/2$，需要 $c=x=a-1$。

**4.3 结果讨论:**

(讨论你计算结果的精度，例如 Γ(1.5) 和整数 Γ(a) 的计算误差大小。评价变量代换和所选数值积分方法的效果。是否遇到了数值计算上的问题？)
[在此处写下你的讨论]

## 5. 结论

(总结本次实验的主要发现和学习到的内容。例如：成功使用变量代换和 [你使用的方法] 计算了伽马函数，验证了其在整数处的阶乘性质，并观察到该方法的精度为 [描述精度水平]。)
[在此处写下你的结论]

## 6. 附录：代码

(可选，可以将你的 Python 代码粘贴在此处)

```python
# [在此处粘贴你的 Python 代码]
```

---
