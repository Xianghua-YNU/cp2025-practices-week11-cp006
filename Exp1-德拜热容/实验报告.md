# 固体德拜热容数值计算实验报告

## 1. 实验目的

本次实验旨在学习和应用数值积分方法（高斯-勒让德积分）计算固体在不同温度下的德拜热容，并分析其随温度变化的规律。

## 2. 实验方法

**2.1 核心公式:**
*   德拜热容积分表达式：
    $C_V(T) = 9 N k_B \left(\frac{T}{\Theta_D}\right)^3 \int_0^{\Theta_D/T} \frac{x^4 e^x}{(e^x - 1)^2} dx$
    其中，$N$ 是原子数，$k_B$ 是玻尔兹曼常数，$T$ 是温度，$\Theta_D$ 是德拜温度。
*   被积函数： $f(x) = \frac{x^4 e^x}{(e^x - 1)^2}$
*   积分上限： $u = \Theta_D / T$

**2.2 数值积分方法:**
实现 `cv(T)` 函数，该函数内部调用 `gauss_quadrature(f, a, b, n)` 函数。
*   `gauss_quadrature` 使用 [ **请在此处填写你选择的高斯积分点数 N，例如：50** ] 点高斯-勒让德积分计算定积分 $\int_0^u f(x) dx$。
*   `cv(T)` 函数根据上述公式计算给定温度 $T$ 下的热容。

**2.3 参数设置:**
*   体积 $V = 1$ m³
*   原子数密度 $\rho = 6.022 \times 10^{28}$ m⁻³ (对应摩尔体积约为 $10^{-5}$ m³/mol)
*   德拜温度 $\Theta_D = 428$ K (以金刚石为例)
*   玻尔兹曼常数 $k_B = 1.380649 \times 10^{-23}$ J/K
*   计算 $N = \rho V$

## 3. 实验结果

**3.1 热容计算结果:**

| 温度 T (K) | 积分上限 u = ΘD/T | 积分值 $\int_0^u f(x) dx$ | 计算热容 CV(T) (J/K) |
| :--------- | :---------------- | :------------------------ | :------------------- |
| 5 | 85.600 | 25.975758 | 3.098942e-01 |
| 50 | 8.560 | 24.253493 | 2.893474e+02 |
| 100 | 4.280 | 12.083518 | 1.153264e+03 |
| 300 | 1.427 | 0.876165 | 2.257797e+03 |
| 500 | 0.856 | 0.201610 | 2.405236e+03 |
| 1000 | 0.428 | 0.025896 | 2.471583e+03 |

**3.2 热容-温度曲线:**

[在此处插入你绘制的热容随温度变化的曲线图]![91aea603a14af739214376637934dce](https://github.com/user-attachments/assets/d55e318d-01a6-4fdc-a10e-2ac803557696)


**图像说明:** (简要描述图像特征，例如低温区的 $T^3$ 行为和高温区的饱和行为)
[在此处填写你的说明]1. **低温区**：温度较低（如 5 到 50 K）时，热容 $C_V$ 与 $T^3$ 成正比，德拜模型曲线与 $T^3$ 定律虚线接近，热容随温度升高以 $T^3$ 形式增长。
2. **高温区**：温度较高（如 300 K 及以上）时，热容 $C_V$ 趋近常数，德拜模型曲线趋于平缓，热容达到饱和，趋近杜隆 - 珀替定律值。
3. **整体**：曲线从低温按 $T^3$ 增长平滑过渡到高温饱和，图像通过网格线、标签、图例、标题清晰展示信息。 

## 4. 分析与讨论

**4.1 结果分析:**
以下是对结果的分析：
* **低温区 (T << ΘD)**：
    - 从计算结果来看，在低温区，随着温度的升高，热容呈现出快速上升的趋势，且上升的速率与温度的三次方成正比。例如，当温度从5K升高到50K时，热容的值有明显的增大，且通过计算可以发现，热容的变化大致符合$C_V \propto T^3$的理论预期。这是因为在低温下，德拜模型中只有少量的低频声子被激发，声子的能量与温度的三次方成正比，从而导致热容也与温度的三次方成正比。
* **高温区 (T >> ΘD)**：
    - 首先计算理论极限值$3Nk_B$，其中$N = V\rho$，已知$V = 1000\times10^{-6} m^3$，$\rho = 6.022\times10^{28} m^{-3}$，$k_B = 1.380649\times10^{-23} J/K$，则$3Nk_B = 3\times V\rho k_B = 3\times1000\times10^{-6}\times6.022\times10^{28}\times1.380649\times10^{-23} \approx 2.49\times10^3 J/K$。
    - 在高温区，当温度达到1000K时，计算得到的热容值逐渐趋近于一个稳定的值，与理论极限值$3Nk_B$较为接近。这是因为在高温下，所有的声子都被激发，声子的能量与温度成正比，根据德拜模型，热容趋近于一个常数，即杜隆 - 珀替定律的极限值$3Nk_B$。从计算结果可以看出，随着温度的进一步升高，热容并没有明显的变化，而是稳定在一个接近理论极限值的范围内，符合杜隆 - 珀替定律的预期。

**4.2 误差讨论:**
(讨论可能的误差来源，例如高斯积分的点数选择、数值精度限制等)
[在此处写下你的讨论]高斯积分点数：点数过少无法精准拟合函数，致积分结果偏差；点数过多增加计算量且易引入舍入误差。
数值精度：计算机有限字长限制数值精度，运算中累积舍入误差，影响结果准确性。

## 5. 结论

(总结本次实验的主要发现和学习到的内容。例如：成功使用高斯积分计算了德拜热容，观察到了热容在低温区的 $T^3$ 行为和高温区的饱和现象，验证了数值计算结果与理论预期的一致性。)
[在此处写下你的结论]运用高斯积分完成德拜热容计算，观测到热容高低温特征，验证数值结果与理论相符，加深对计算方法及热容理论的理解。

## 6. 附录：代码

(可选，可以将你的 Python 代码粘贴在此处)

```python
# [在此处粘贴你的 Python 代码]import numpy as np
import matplotlib.pyplot as plt

# 物理常数
kB = 1.380649e-23  # 玻尔兹曼常数，单位：J/K

# 样本参数
V = 1000e-6  # 体积，1000立方厘米转换为立方米
rho = 6.022e28  # 原子数密度，单位：m^-3
theta_D = 428  # 德拜温度，单位：K

def integrand(x):
    """被积函数：x^4 * e^x / (e^x - 1)^2
    
    这个函数表示德拜模型中的能量分布。分子中的x^4表示声子态密度，
    分母中的(e^x - 1)^2表示玻色-爱因斯坦分布的导数。
    
    参数：
    x : float 或 numpy.ndarray
        积分变量，代表约化能量 (E/kT)
    
    返回：
    float 或 numpy.ndarray：被积函数的值
    """
    # 对于数组输入，逐个计算每个元素
    if isinstance(x, np.ndarray):
        return np.array([integrand(xi) for xi in x])
    
    # 对于单个值的计算
    exp_x = np.exp(x)
    return x**4 * exp_x / (exp_x - 1)**2

def gauss_quadrature(f, a, b, n):
    """实现高斯-勒让德积分
    
    使用高斯-勒让德求积公式计算定积分。这个方法对于光滑函数特别有效，
    使用n个点就可以精确积分2n-1次多项式。
    
    参数：
    f : callable
        被积函数
    a, b : float
        积分区间的端点
    n : int
        高斯点的数量
    
    返回：
    float：积分结果
    """
    # 获取高斯-勒让德求积的节点和权重
    x, w = np.polynomial.legendre.leggauss(n)
    
    # 将[-1,1]区间映射到[a,b]区间
    t = 0.5 * (x + 1) * (b - a) + a
    
    # 计算积分
    return 0.5 * (b - a) * np.sum(w * f(t))

def cv(T):
    """计算给定温度T下的热容
    
    根据德拜模型计算固体的热容。该模型在低温下给出T^3定律，
    在高温下趋近于杜隆-珀替定律的预测值。
    
    参数：
    T : float
        温度，单位：K
    
    返回：
    float：热容值，单位：J/K
    """
    # 计算积分上限
    upper_limit = theta_D / T
    
    # 使用高斯积分计算
    integral = gauss_quadrature(integrand, 0, upper_limit, 50)
    
    # 计算热容
    return 9 * V * rho * kB * (T / theta_D)**3 * integral

def plot_cv():
    """绘制热容随温度的变化曲线
    
    生成一个专业的图表，展示热容随温度的变化。包括：
    - 合适的坐标轴标签
    - 网格线
    - 图例
    - 标题
    """
    # 生成温度点（使用线性间距）
    T = np.linspace(5, 500, 200)
    
    # 计算对应的热容值
    C_V = np.array([cv(t) for t in T])
    
    # 创建图表
    plt.figure(figsize=(10, 6))
    
    # 绘制热容曲线
    plt.plot(T, C_V, 'b-', label='Debye Model')
    
    # 添加参考线
    # 低温T^3行为
    T_low = np.linspace(5, 50, 50)
    C_low = cv(50) * (T_low/50)**3
    plt.plot(T_low, C_low, 'r--', label='T³ Law')
    
    # Add labels and title
    plt.xlabel('Temperature (K)')
    plt.ylabel('Heat Capacity (J/K)')
    plt.title('Solid Heat Capacity vs Temperature (Debye Model)')
    
    # Add grid
    plt.grid(True, which='both', ls='-', alpha=0.2)
    
    # Add legend
    plt.legend()
    
    # 显示图表
    plt.show()

def main():
    # 测试一些特征温度点的热容值
    test_temperatures = [5, 100, 300, 500]
    print("\n测试不同温度下的热容值：")
    print("-" * 40)
    print("温度 (K)\t热容 (J/K)")
    print("-" * 40)
    for T in test_temperatures:
        result = cv(T)
        print(f"{T:8.1f}\t{result:10.3e}")
    
    # 绘制热容曲线
    plot_cv()

if __name__ == '__main__':
    main()
```
